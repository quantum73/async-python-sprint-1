Добрый день, уважаемый ревьюер!)

Постарался сепарировать код и сделать его более прямолинейным.<br> 
Но есть ощущение, что всё равно наговнокодил)

Также `mypy` ругался на типы при работе с `sorted` и `filter` с пандасовскими датафреймами.<br>
Решил это не используя лямбды, а явно реализовав функции для фильтрации и сортировки.

В целом буду рад любой доп информации по best practices языка, стиля кода, архитектурным штукам, 
структурам данных паттернам и прочим. В общем, готов поглощать информацию!)